<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <h2>Welcome back, <%= userName %></h2>

    <h4>Create New Post:</h4>
    <form class="" action="#" method="post">

      <label for="topic">Topic: </label>
      <select class="" name="topic">
        <option value="Chicago">Chicago</option>
        <option value="JavaScript">JavaScript</option>
        <option value="HTML">HTML</option>
        <option value="CSS">CSS</option>
        <option value="jQuery">jQuery</option>
        <option value="DOM">DOM</option>
        <option value="SQL">SQL</option>
        <option value="PostgreSQL">PostgreSQL</option>
        <option value="AJAX">AJAX</option>
        <option value="Node/Node Modules">Node/Node Modules</option>
        <option value="Heroku">Heroku</option>
        <option value="React">React</option>
        <option value="General Backend Questions">General Backend Questions</option>
        <option value="General Frontend Questions">General Frontend Questions</option>
        <option value="Other">Other</option>
      </select>

      <label for="title">Title</label>
      <input type="text" name="title" placeholder="i.e.: JavaScript - Accumulator Pattern">

      <label for="content">Content: </label>
      <input type="text" name="content" placeholder="Briefly describe what you need help with">

      <input type="submit" name="" value="Submit">
    </form>

    <h4>All Posts</h4>
    <% if (posts[0]) { %>
      <% for (let i = 0; i < posts.length; i++) { %>

        <p>REQUESTED BY: <%= posts[i].first_name %> <%= posts[i].last_name %></p>
        <p>TOPIC: <%= posts[i].topic %></p>
        <p>TITLE: <%= posts[i].title %></p>
        <p>CONTENT: <%= posts[i].content %></p>

        <% if (posts[i].user_id == loggedUserID) { %>
          <a class="btn orange" href="#">EDIT</a>
        <% } else { %>
          <% if (posts[i].status === "PENDING") {
               let myHelps = helps.filter((post) => {
                 if (post.id === posts[i].id) {
                   if (post.user_id === loggedUserID) {
                     return post;
                   }
                 }
               });
            if (myHelps[0]) { %>
              <a class="btn disabled" href="#">You have offered to help - Waiting on OP's reply.</a>
            <% } else { %>
              <a class="btn" href="#">Offer To Help</a>
            <% } %>
          <% } else { %>
            <a class="button" href="#">Offer To Help</a>
          <% } %>
        <% } %>
      <% } %>
    <% } else { %>
      <p>No posts yet :-(</p>
    <% } %>

    <h4>Your Posts</h4>
    <% if (personalPosts[0]) { %>
      <% for (let i = 0; i < personalPosts.length; i++) {
          let date = String(personalPosts[i].created_at);
          date = date.split(" ");
      %>
        <p>Posted On: <%= date[0] %> <%= date[1] %> <%= date[2] %> <%= date[3] %></p>
        <p>TOPIC: <%= personalPosts[i].topic %></p>
        <p>TITLE: <%= personalPosts[i].title %></p>
        <p>CONTENT: <%= personalPosts[i].content %></p>
      <% } %>
    <% } else { %>
      <p>No posts yet :-(</p>
    <% } %>
  </body>
</html>
